/*  The MIT License (MIT)
**  
**  Copyright (c) 2014 Chad Seaman
**  
**  http://github.com/chadillac/MoshPit.js
**  
**  Permission is hereby granted, free of charge, to any person obtaining a copy
**  of this software and associated documentation files (the "Software"), to deal
**  in the Software without restriction, including without limitation the rights
**  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
**  copies of the Software, and to permit persons to whom the Software is
**  furnished to do so, subject to the following conditions:
**  
**  The above copyright notice and this permission notice shall be included in all
**  copies or substantial portions of the Software.
**  
**  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
**  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
**  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
**  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
**  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
**  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
**  SOFTWARE.
*/
(function(){var e={mobile:{min:0,max:480},tablet:{min:481,max:1024},desktop:{min:1025,max:1820},desktop_wide:{min:1821,max:99999999}};(function(t){"use strict";var n,s;var i={shown:{prefix:"",postfix:"_shown"},state:{prefix:"state_",postfix:""}};var a={};var o={};var r={get_namespace:function(e){var t=false;if(e instanceof jQuery){t=e.attr("id")}else if(typeof e=="string"){if(e.indexOf("#")==0){e=e.substr(1)}t=e}return t},csv_to_class:function(e,n,s){var n=typeof n!="undefined"&&n.length?" "+n:"";var s=typeof s!="undefined"&&s.length?s+" ":"";e=e.replace(/\s/g,"");e=e.split(",").join("[post],").split(",").join("[pre]");e=e.replace("[post]",s).replace("[pre]",n);e=n+e+s;return t.trim(e)},exec_on_view_csv:function(e,n){var e=e.replace(/\s/g,"").split(",");for(var s=0,i=e.length;s<i;s++){var a=e[s];var o=t("#"+r.get_namespace(a));n.call(f,o)}},exec_on_state_csv:function(e,t){var e=e.replace(/\s/g,"").split(",");for(var n=0,s=e.length;n<s;n++){var i=e[n];t.call(f,i)}},shown_class:function(e){e=e.replace(/#/g,"");return r.csv_to_class(e,i.shown.prefix,i.shown.postfix)},state_chain:function(e){e=e.replace(/#/g,"");return r.csv_to_class(e,i.state.prefix,i.state.postfix)},get_sizes_chain:function(){if(this.sizes_chain){return this.sizes_chain}var e="";for(var n in a){if(a.hasOwnProperty(n)){e+=n+" "}}this.sizes_chain=t.trim(e);return this.sizes_chain},get_size:function(){var e=t(window).width();for(var n in a){var s=a[n].min;var i=a[n].max;if(a.hasOwnProperty(n)){if(e>=s&&e<=i){return n}}}},is_shown:function(e){return s.hasClass(r.shown_class(e))},has_state:function(e){return n.hasClass(i.state.prefix+e+i.state.postfix)},jquery_funcs:false,jquery_inject:function(){if(r.jquery_funcs===false){r.jquery_funcs={};r.jquery_funcs.show=t.fn.show;t.fn.show=function(){var e=r.get_namespace(t(this));if(f.views[e]){c.show(e);return this}else{return r.jquery_funcs.show.apply(this,arguments)}};r.jquery_funcs.hide=t.fn.hide;t.fn.hide=function(){var e=r.get_namespace(t(this));if(f.views[e]){c.hide(e);return this}else{return r.jquery_funcs.show.apply(this,arguments)}};r.jquery_funcs.toggle=t.fn.toggle;t.fn.toggle=function(){var e=r.get_namespace(t(this));if(f.views[e]){c.toggle(e);return this}else{return r.jquery_funcs.toggle.apply(this,arguments)}}}}};var c={hide:function(e){s.removeClass(r.shown_class(r.get_namespace(e)))},show:function(e){s.addClass(r.shown_class(r.get_namespace(e)))},toggle:function(e){e=r.get_namespace(e);if(r.is_shown(e)){c.hide(e)}else{c.show(e)}},marionette_hide:function(){c.hide(r.get_namespace(this.el))},marionette_show:function(){c.show(r.get_namespace(this.el))},add_state:function(e){n.addClass("state_"+e)},del_state:function(e){n.removeClass("state_"+e)},toggle_state:function(e){if(r.has_state(e)){c.del_state(e)}else{c.add_state(e)}},resize:function(e,t){clearTimeout(o.resize);if(t){n.removeClass(r.get_sizes_chain()).addClass(r.get_size());return}o.resize=setTimeout(c.resize,100,e,true)},click:function(e){var n=t(e.currentTarget);var s=n.data("moshpit");var i=n.data("view");var a=n.data("state");if(i||a){if(typeof c[s]=="function"){if(a){r.exec_on_state_csv(a,c[s])}else{r.exec_on_view_csv(i,c[s])}e.preventDefault()}}}};var f={views:{},add_marionette:function(e){e.on("show",c.marionette_show);e.on("close",c.marionette_hide);f.add_jquery.call(f,t(e.el))},del_marionette:function(e){e.off("show",c.marionette_show);e.off("close",c.marionette_hide);f.del_jquery.call(f,t(e.el))},add_jquery:function(e){r.jquery_inject();var t=r.get_namespace(e);f.views[t]=true},del_jquery:function(e){var t=r.get_namespace(e);f.views[t]=false;c.hide(t)}};window.MoshPit={join:function(e){if(typeof e=="string"){r.exec_on_view_csv(e,f.add_jquery)}else if(typeof e=="object"){if(e instanceof jQuery){f.add_jquery.call(f,e)}else if(e instanceof Marionette.Region||e instanceof Marionette.View||e instanceof Marionette.ItemView||e instanceof Marionette.Layout){f.add_marionette.call(f,e)}}return MoshPit},leave:function(e){if(typeof e=="string"){r.exec_on_view_csv(e,f.del_jquery)}else if(typeof e=="object"){if(e instanceof jQuery){f.del_jquery.call(f,e)}else if(e instanceof Marionette.Region||e instanceof Marionette.View||e instanceof Marionette.ItemView||e instanceof Marionette.Layout){f.del_marionette.call(f,e)}}return MoshPit},show:function(e){r.exec_on_view_csv(e,c.show);return MoshPit},hide:function(e){r.exec_on_view_csv(e,c.hide);return MoshPit},toggle:function(e){r.exec_on_view_csv(e,c.toggle);return MoshPit},is_shown:function(e){return r.is_shown(r.get_namespace(e))},add_state:function(e){r.exec_on_state_csv(e,c.add_state);return MoshPit},remove_state:function(e){r.exec_on_state_csv(e,c.del_state);return MoshPit},toggle_state:function(e){r.exec_on_state_csv(e,c.toggle_state);return MoshPit},has_state:r.has_state};var _=function(){a=e;c.resize();n=t("html");s=t("body");t(window).on("resize",c.resize);t(document).on("click","[data-moshpit]",c.click)};t(_)})(jQuery)})();