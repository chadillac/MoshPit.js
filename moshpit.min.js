/*  The MIT License (MIT)
**  
**  Copyright (c) 2014 Chad Seaman
**  
**  http://github.com/chadillac/MoshPit.js
**  
**  Permission is hereby granted, free of charge, to any person obtaining a copy
**  of this software and associated documentation files (the "Software"), to deal
**  in the Software without restriction, including without limitation the rights
**  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
**  copies of the Software, and to permit persons to whom the Software is
**  furnished to do so, subject to the following conditions:
**  
**  The above copyright notice and this permission notice shall be included in all
**  copies or substantial portions of the Software.
**  
**  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
**  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
**  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
**  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
**  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
**  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
**  SOFTWARE.
*/
(function(){(function(e){"use strict";window.MoshPitSizes={mobile:{min:0,max:480},tablet:{min:481,max:1024},desktop:{min:1025,max:1820},"desktop-wide":{min:1821,max:99999999}};var t,s;var n={shown:{prefix:"",postfix:"-shown"},state:{prefix:"state-",postfix:""}};var i={};var a={};var o={get_namespace:function(e){var t=false;if(e instanceof jQuery){t=e.attr("id")}else if(typeof e=="string"){if(e.indexOf("#")==0){e=e.substr(1)}t=e}return t},csv_to_class:function(t,s,n){var s=typeof s!="undefined"&&s.length?" "+s:"";var n=typeof n!="undefined"&&n.length?n+" ":"";t=t.replace(/\s/g,"");t=t.split(",").join("[post],").split(",").join("[pre]");t=t.replace("[post]",n).replace("[pre]",s);t=s+t+n;return e.trim(t)},exec_on_view_csv:function(t,s){var t=t.replace(/\s/g,"").split(",");for(var n=0,i=t.length;n<i;n++){var a=t[n];var r=e("#"+o.get_namespace(a));s.call(c,r)}},exec_on_state_csv:function(e,t){var e=e.replace(/\s/g,"").split(",");for(var s=0,n=e.length;s<n;s++){var i=e[s];t.call(c,i)}},shown_class:function(e){e=e.replace(/#/g,"");return o.csv_to_class(e,n.shown.prefix,n.shown.postfix)},state_chain:function(e){e=e.replace(/#/g,"");return o.csv_to_class(e,n.state.prefix,n.state.postfix)},get_sizes_chain:function(){if(this.sizes_chain){return this.sizes_chain}var t="";for(var s in i){if(i.hasOwnProperty(s)){t+=s+" "}}this.sizes_chain=e.trim(t);return this.sizes_chain},get_size:function(){var t=e(window).width();for(var s in i){var n=i[s].min;var a=i[s].max;if(i.hasOwnProperty(s)){if(t>=n&&t<=a){return s}}}},is_shown:function(e){return s.hasClass(o.shown_class(e))},has_state:function(e){return t.hasClass(n.state.prefix+e+n.state.postfix)},jquery_funcs:false,jquery_inject:function(){if(o.jquery_funcs===false){o.jquery_funcs={};o.jquery_funcs.show=e.fn.show;e.fn.show=function(){var t=o.get_namespace(e(this));if(c.views[t]){r.show(t);return this}else{return o.jquery_funcs.show.apply(this,arguments)}};o.jquery_funcs.hide=e.fn.hide;e.fn.hide=function(){var t=o.get_namespace(e(this));if(c.views[t]){r.hide(t);return this}else{return o.jquery_funcs.show.apply(this,arguments)}};o.jquery_funcs.toggle=e.fn.toggle;e.fn.toggle=function(){var t=o.get_namespace(e(this));if(c.views[t]){r.toggle(t);return this}else{return o.jquery_funcs.toggle.apply(this,arguments)}}}}};var r={hide:function(e){s.removeClass(o.shown_class(o.get_namespace(e)))},show:function(e){s.addClass(o.shown_class(o.get_namespace(e)))},toggle:function(e){e=o.get_namespace(e);if(o.is_shown(e)){r.hide(e)}else{r.show(e)}},marionette_hide:function(){r.hide(o.get_namespace(this.el))},marionette_show:function(){r.show(o.get_namespace(this.el))},add_state:function(e){t.addClass(n.state.prefix+e+n.state.postfix)},del_state:function(e){t.removeClass(n.state.prefix+e+n.state.postfix)},toggle_state:function(e){if(o.has_state(e)){r.del_state(e)}else{r.add_state(e)}},resize:function(e,s){clearTimeout(a.resize);if(s){t.removeClass(o.get_sizes_chain()).addClass(o.get_size());return}a.resize=setTimeout(r.resize,100,e,true)},click:function(t){var s=e(t.currentTarget);var n=s.data("moshpit");var i=s.data("view");var a=s.data("state");if(i||a){if(typeof r[n]=="function"){if(a){o.exec_on_state_csv(a,r[n])}else{o.exec_on_view_csv(i,r[n])}t.preventDefault()}}}};var c={views:{},add_marionette:function(t){t.on("show",r.marionette_show);t.on("close",r.marionette_hide);c.add_jquery.call(c,e(t.el))},del_marionette:function(t){t.off("show",r.marionette_show);t.off("close",r.marionette_hide);c.del_jquery.call(c,e(t.el))},add_jquery:function(e){o.jquery_inject();var t=o.get_namespace(e);c.views[t]=true},del_jquery:function(e){var t=o.get_namespace(e);c.views[t]=false;r.hide(t)}};window.MoshPit={join:function(e){if(typeof e=="string"){o.exec_on_view_csv(e,c.add_jquery)}else if(typeof e=="object"){if(e instanceof jQuery){c.add_jquery.call(c,e)}else if(e instanceof Marionette.Region||e instanceof Marionette.View||e instanceof Marionette.ItemView||e instanceof Marionette.Layout){c.add_marionette.call(c,e)}}return MoshPit},leave:function(e){if(typeof e=="string"){o.exec_on_view_csv(e,c.del_jquery)}else if(typeof e=="object"){if(e instanceof jQuery){c.del_jquery.call(c,e)}else if(e instanceof Marionette.Region||e instanceof Marionette.View||e instanceof Marionette.ItemView||e instanceof Marionette.Layout){c.del_marionette.call(c,e)}}return MoshPit},show:function(e){o.exec_on_view_csv(e,r.show);return MoshPit},hide:function(e){o.exec_on_view_csv(e,r.hide);return MoshPit},toggle:function(e){o.exec_on_view_csv(e,r.toggle);return MoshPit},is_shown:function(e){return o.is_shown(o.get_namespace(e))},add_state:function(e){o.exec_on_state_csv(e,r.add_state);return MoshPit},remove_state:function(e){o.exec_on_state_csv(e,r.del_state);return MoshPit},toggle_state:function(e){o.exec_on_state_csv(e,r.toggle_state);return MoshPit},has_state:o.has_state,get_size:o.get_size};var f=function(){i=window.MoshPitSizes;r.resize();t=e("html");s=e("body");e(window).on("resize",r.resize);e(document).on("click","[data-moshpit]",r.click)};e(f)})(jQuery)})();